require(phangorn); require(ape); require(plyr); require(ape)

# read nexus data
tree <- read.nexus.data("~/Downloads/njtree/vamosi_constraints_new.nex")

# convert ape format to phangorn format
phang_ <- phyDat(tree, return.index = T) 

# fit different evolutionary models to the dataset using fxn modelTest
fish_njtree <- NJ(dist.logDet(phang_)) # create neighbor joining tree for use in modelTest

plot(fish_njtree)

write.tree(fish_njtree, file="~/Downloads/njtree/vamositree1_ml.txt")

# tree
treetext <- "((((Alosa_aestivalis:0.00000233234985415647,Alosa_pseudoharengus:0.00267232270275472245):0.01329104853646649251,Alosa_sapidissima:0.00828882830479570586):0.23265508453809849443,(((Ameiurus_nebulosus:0.21002397112157208947,((Catostomus_catostomus:0.03300705917246483934,Catostomus_commersonii:0.04846582188003753511):0.04574831194155234981,(Carassius_auratus:0.07830450158509198733,(((Notemigonus_crysoleucas:0.03091942009611678074,((Couesius_plumbeus:0.01794776611772807076,Margariscus_margarita:0.02475065520025750143):0.00745461476297111687,(Semotilus_atromaculatus:0.01276235787038685135,Semotilus_corporalis:0.08661478588148192881):0.00653848153167760522):0.00460131565031238112):0.00306765489126201423,(Rhinichthys_atratulus:0.03277050511921399123,(Notropis_atherinoides:0.05530417037313699324,(((Pimephales_promelas:0.02127789661014163961,Pimephales_notatus:0.01238477321973867167):0.00738797431254753067,(((Notropis_chrosomus:0.03873017492174062049,Notropis_heterolepis:0.03007678040307213904):0.01069015501320034339,Luxilus_cornutus:0.03528147853478129370):0.00179500079793081359,Notropis_leuciodus:0.01441596544426860561):0.00294004974307067977):0.00480970101335025362,Notropis_hudsonius:0.04426222863447427242):0.00024763280258801099):0.01833484072356005024):0.00732188851607220616):0.00760980357142712616,(Phoxinus_eos:0.00139500084668983280,Chrosomus_neogaeus:0.00102730971615107736):0.06935767356308841780):0.04234337056617380052):0.04401042021516657354):0.08206647539260628066):0.06863090443085213821,Anguilla_rostrata:0.21553423172112307071):0.02323618456377211233,((((Esox_masquinongy:0.05197123609947093548,Esox_niger:0.04812028133532575414):0.05918053933478707035,Umbra_limi:0.10664915876821379204):0.02842378053231879240,(((Coregonus_artedi:0.01728207494178778808,Coregonus_clupeaformis:0.00732911597479757836):0.02067988296446382837,Prosopium_cylindraceum:0.08103813013203403637):0.00898346739618572851,(Oncorhynchus_mykiss:0.03907697675390633257,((Salvelinus_fontinalis:0.03014713889778532219,(Salvelinus_namaycush:0.01069368901446977708,Salvelinus_alpinus:0.00318351397021889287):0.00358083993957657555):0.01083976915451229962,(Salmo_salar:0.02974255675708818367,Salmo_trutta:0.01625252319124867104):0.02088378603139701140):0.00594630051849979763):0.01320643039577364293):0.05092842259218990919):0.10156168517004854346,((Microgadus_tomcod:0.05983662240855466136,Lota_lota:0.07830070125488318433):0.09781155346661084271,(Percopsis_omiscomaycus:0.17611238998304534764,(((Morone_saxatilis:0.02521669788750658184,Morone_americana:0.08574195446261964615):0.11583185589985085795,(Fundulus_heteroclitus:0.04626182890030706291,Fundulus_diaphanus:0.01791525871107665230):0.11636173460045937111):0.03152991510566958977,((((Micropterus_dolomieu:0.00907447307203271443,Micropterus_salmoides:0.00542569982512885844):0.01299147577134268997,((Lepomis_auritus:0.02114826880565604320,Lepomis_gibbosus:0.02975345863671190541):0.01726095795771472735,Lepomis_macrochirus:0.01329014887210963440):0.01492754584466383407):0.00746705276348364096,Ambloplites_rupestris:0.01990251339604797928):0.03374479816422952527,(((Petromyzon_marinus:0.23909297081271327357,((Culaea_inconstans:0.03759363527068618205,Pungitius_pungitius:0.02724871841535010664):0.00808031573768763084,((Gasterosteus_aculeatus:0.01957488084428619241,Gasterosteus_wheatlandi:0.02615435247266288329):0.02598991354131958975,Apeltes_quadracus:0.05008366208794299418):0.00671453064862284447):0.03806105000084363671):0.01760768585056744079,((Cottus_bairdii:0.00865096757335095772,Cottus_cognatus:0.01058048604563402093):0.00436590239791009947,Cottus_ricei:0.02032788067365178669):0.10874925978005615945):0.02222019875378214784,((Percina_caprodes:0.02230354771865289062,(Etheostoma_nigrum:0.02529044142497332420,Etheostoma_exile:0.03064162600033391165):0.01372261782810263279):0.01175290042004734602,(Sander_vitreus:0.03969649252542217094,Perca_flavescens:0.02368899546238406942):0.00516211430422149845):0.03491808483708202376):0.00854443886198458930):0.02553437339761837482):0.07570090165435709728):0.02329916351740742020):0.07329342146228054466):0.04491305193446663152):0.03589580277844588163):0.10415090202772517292,Acipenser_oxyrinchus:0.03793853778113051578,Acipenser_brevirostrum:0.03070466518300616829):0.0;"
read.tree(text="~/Downloads/raxmlHPC/RAxML_bestTree.test.out")
